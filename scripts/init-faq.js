const Database = require('better-sqlite3');
const path = require('path');

try {
  const dbPath = path.join(__dirname, '..', 'site-settings.db');
  const db = new Database(dbPath);

  console.log('๐ฆ ุฅูุดุงุก ุฌุฏูู ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ...');

  // Create FAQ table
  db.exec(`
    CREATE TABLE IF NOT EXISTS faq (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      question TEXT NOT NULL,
      answer TEXT NOT NULL,
      displayOrder INTEGER NOT NULL DEFAULT 0,
      isActive INTEGER NOT NULL DEFAULT 1,
      createdAt TEXT DEFAULT CURRENT_TIMESTAMP,
      updatedAt TEXT DEFAULT CURRENT_TIMESTAMP
    )
  `);

  // Check if table has data
  const count = db.prepare('SELECT COUNT(*) as count FROM faq').get();
  
  if (count.count === 0) {
    console.log('๐ ุฅุถุงูุฉ ุงูุจูุงูุงุช ุงูุงูุชุฑุงุถูุฉ...');
    
    // Insert default FAQ items
    const defaultFAQs = [
      {
        question: 'ูุง ูู ุงูููุตุฉ ูููู ุชุนููุ',
        answer: 'ููุตุชูุง ูู ุญููุฉ ุงููุตู ุจููู ูุจูู ุฃูุถู ุดุฑูุงุช ุงูุชุตููู ูุงูุจูุงุก ูู ุงูููููุฉ. ูููุฑ ูู ุฏูููุงู ุดุงููุงู ููุดุฑูุงุช ุงููุนุชูุฏุฉ ูุน ุฅููุงููุฉ ุงูููุงุฑูุฉ ูุงูุชูุงุตู ุงููุจุงุดุฑุ ุจุงูุฅุถุงูุฉ ุฅูู ูุงุด ุจุงู 2% ุนูุฏ ุฅุชูุงู ุงูุชุนุงูุฏ.',
        displayOrder: 1
      },
      {
        question: 'ููู ุฃุญุตู ุนูู ุงููุงุด ุจุงูุ',
        answer: 'ุนูุฏ ุฅุชูุงู ุงูุชุนุงูุฏ ูุน ุฅุญุฏู ุงูุดุฑูุงุช ุงููุนุชูุฏุฉ ุนุจุฑ ููุตุชูุงุ ุณุชุญุตู ุชููุงุฆูุงู ุนูู ูุงุด ุจุงู ุจูุณุจุฉ 2% ูู ูููุฉ ุงูุนูุฏ. ูุชู ุชุญููู ุงููุจูุบ ุฅูู ุญุณุงุจู ุฎูุงู 7 ุฃูุงู ุนูู ูู ุชุฃููุฏ ุงูุนูุฏ.',
        displayOrder: 2
      },
      {
        question: 'ูู ุงูุฎุฏูุฉ ูุฌุงููุฉ ูููุณุชุฎุฏูููุ',
        answer: 'ูุนูุ ุงุณุชุฎุฏุงู ุงูููุตุฉ ูุฌุงูู ุจุงููุงูู ูููุณุชุฎุฏููู. ููููู ุชุตูุญ ุงูุดุฑูุงุชุ ุงูููุงุฑูุฉ ุจูููุงุ ูุงูุชูุงุตู ูุนูุง ุฏูู ุฃู ุฑุณูู. ุจู ููุฏู ูู ูุงุด ุจุงู ุนูุฏ ุฅุชูุงู ุงูุชุนุงูุฏ!',
        displayOrder: 3
      },
      {
        question: 'ููู ูุชู ุงุฎุชูุงุฑ ุงูุดุฑูุงุช ุงููุนุชูุฏุฉุ',
        answer: 'ูุชุจุน ูุนุงููุฑ ุตุงุฑูุฉ ูู ุงุฎุชูุงุฑ ุงูุดุฑูุงุช ุงููุนุชูุฏุฉุ ุชุดูู: ุงูุชุฑุงุฎูุต ุงูุฑุณููุฉุ ุณุฌู ุงูุฃุนูุงู ุงูุณุงุจูุฉุ ุชููููุงุช ุงูุนููุงุกุ ูุงูุงูุชุฒุงู ุจูุนุงููุฑ ุงูุฌูุฏุฉ. ูุฑุงุฌุน ูู ุดุฑูุฉ ุจุฏูุฉ ูุจู ูุจูููุง ูู ุงูููุตุฉ.',
        displayOrder: 4
      },
      {
        question: 'ูุง ูู ุงูุฎุฏูุงุช ุงููุชููุฑุฉุ',
        answer: 'ูููุฑ ูุฌููุนุฉ ุดุงููุฉ ูู ุงูุฎุฏูุงุช ุชุดูู: ุงูุชุตููู ุงููุนูุงุฑูุ ุงูุชุตููู ุงูุฏุงุฎููุ ุงูุฅุดุฑุงู ุนูู ุงูุชูููุฐุ ุงูููุงููุงุช ุงูุนุงูุฉุ ุงูุชุดุทูุจุงุชุ ูุฃุนูุงู ุงูุฏูููุฑ. ูู ุฐูู ูู ุฎูุงู ุดุฑูุงุช ูุนุชูุฏุฉ ููุชุฎุตุตุฉ.',
        displayOrder: 5
      },
      {
        question: 'ูู ูููููู ุชูููู ุงูุดุฑูุงุชุ',
        answer: 'ูุนูุ ูุดุฌุน ุฌููุน ุนููุงุฆูุง ุนูู ุชูููู ุชุฌุฑุจุชูู ูุน ุงูุดุฑูุงุช ุจุนุฏ ุงูุชูุงุก ุงููุดุฑูุน. ุงูุชููููุงุช ุชุณุงุนุฏ ุงููุณุชุฎุฏููู ุงูุขุฎุฑูู ูู ุงุชุฎุงุฐ ูุฑุงุฑุงุช ูุฏุฑูุณุฉ ูุชุญูุฒ ุงูุดุฑูุงุช ุนูู ุชูุฏูู ุฃูุถู ุฎุฏูุฉ.',
        displayOrder: 6
      }
    ];

    const insertStmt = db.prepare(`
      INSERT INTO faq (question, answer, displayOrder)
      VALUES (?, ?, ?)
    `);

    for (const faq of defaultFAQs) {
      insertStmt.run(faq.question, faq.answer, faq.displayOrder);
    }

    console.log(`โ ุชู ุฅุถุงูุฉ ${defaultFAQs.length} ุณุคุงู ุงูุชุฑุงุถู!`);
  } else {
    console.log('โน๏ธ  ุงูุฌุฏูู ูุญุชูู ุจุงููุนู ุนูู ุจูุงูุงุช');
  }

  console.log('โ ุชู ุฅูุดุงุก ุฌุฏูู faq ุจูุฌุงุญ!');
  
  db.close();
  process.exit(0);
} catch (error) {
  console.error('โ ุญุฏุซ ุฎุทุฃ:', error.message);
  process.exit(1);
}
